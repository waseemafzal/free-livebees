(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"0taS":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("N1MX"),i=n("fXoL");let s=(()=>{class t extends o.SettingsManager{constructor(t,e){super(t,e)}getSectionsCommentTemplateType(t){const e=this.getSectionsComments(t);try{switch(this._getString(e,"template",null)){case"disqus":case"GBCommentTemplateTypeDisqus":return o.CommentTemplateType.Disqus;case"classic":case"GBCommentTemplateTypeClassic":default:return o.CommentTemplateType.Classic}}catch(n){return this._logger.info(`Impossible to get the comment template type for section ${t}, default value : classic`),o.CommentTemplateType.Classic}}getSectionsDetailCommentsRedBadgeEnabled(t){return!this._getBoolean(this.getSectionsDetail(t),"redBadgeDisabled",!1)}getSectionsDisqusShortName(t){return this._getString(this.getSections(t),"disqusShortname",null)}getGeneralCommentsListBackgroundColor(){return this._getString(this.getGeneralComments(),"listBackgroundColor",this.getGeneralBackgroundColor())}getGeneralCommentsListBackgroundOpacity(){return this._getNumber(this.getGeneralComments(),"listBackgroundOpacity",1)}getGeneralCommentsShowThumb(){return this._getBoolean(this.getGeneralComments(),"showThumb",!1)}getGeneralCommentsPostBarBackgroundColor(){return this._getString(this.getGeneralComments(),"postBarBackgroundColor","#ffffff")}getGeneralCommentsPostBarIconColor(){return this._getString(this.getGeneralComments(),"postBarIconColor","#000000")}getGeneralCommentsAuthorFont(){return this.getFont(this.getGeneralComments(),"authorFont",new o.GBFont({color:"#000000",size:22,fontType:"Helvetica neue"}),"primary2Color")}getGeneralCommentsDateFont(){return this.getFont(this.getGeneralComments(),"dateFont",new o.GBFont({color:"#000000",size:16,fontType:"Helvetica neue"}),"primary1Color")}getGeneralCommentsTextFont(){return this.getFont(this.getGeneralComments(),"textFont",new o.GBFont({color:"#000000",size:18,fontType:"Helvetica neue"}),"primary2Color")}getGeneralCommentsDateToken(){return this._getString(this.getGeneralComments(),"commentsDate",this._languagesManager.getInfosContentTypeComments())}getSectionsCommentsListBackgroundColor(t){return this.getColor(this.getSectionsComments(t),"listBackgroundColor",this.getGeneralCommentsListBackgroundColor(),"primary4Color")}getSectionsCommentsListBackgroundOpacity(t){return this._getNumber(this.getSectionsComments(t),"listBackgroundOpacity",this.getGeneralCommentsListBackgroundOpacity())}getSectionsCommentsShowThumb(t){return this._getBoolean(this.getSectionsComments(t),"showThumb",this.getGeneralCommentsShowThumb())}getSectionsCommentsAuthorFont(t){return this.getFont(this.getSectionsComments(t),"authorFont",this.getGeneralCommentsAuthorFont())}getSectionsCommentsDateFont(t){return this.getFont(this.getSectionsComments(t),"dateFont",this.getGeneralCommentsDateFont())}getSectionsCommentsTextFont(t){return this.getFont(this.getSectionsComments(t),"textFont",this.getGeneralCommentsTextFont())}getSectionsCommentsDateToken(t){return this._getString(this.getSectionsComments(t),"commentsDate",this.getGeneralCommentsDateToken())}getSectionsCommentsPostBarBackgroundColor(t){return this.getColor(this.getSectionsComments(t),"postBarBackgroundColor",this.getGeneralCommentsPostBarBackgroundColor(),"buttonBackgroundColor")}getSectionsCommentsPostBarIconColor(t){return this.getColor(this.getSectionsComments(t),"postBarIconColor",this.getGeneralCommentsPostBarIconColor(),"buttonTextColor")}getSectionsCommentsPostButton(t,e){return this.getButton(this.getSectionsComments(t),"postButton",null,e)}getSectionsComments(t){return this._getObject(this.getSections(t),"comments")}getGeneralComments(){return this._getObject(this._json,"comments")}}return t.\u0275fac=function(e){return new(e||t)(i.Wb(o.LanguagesManager),i.Wb(o.Logger))},t.\u0275prov=i.Ib({token:t,factory:function(t){return t?new t:r(i.Wb(o.SettingsManager),i.Wb(o.LanguagesManager),i.Wb(o.Logger))},providedIn:"root"}),t})();function r(t,e,n){let o=new s(e,n);return o.settings=t.settings,o}},"E+bX":function(t,e,n){"use strict";var o=n("XGRJ");n.d(e,"b",(function(){return o.b}));var i=n("Ta8m");n.d(e,"a",(function(){return i.a}))},Ta8m:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("jXgJ"),i=n("fXoL");let s=(()=>{class t{}return t.\u0275mod=i.Kb({type:t}),t.\u0275inj=i.Jb({factory:function(e){return new(e||t)},imports:[[o.a]]}),t})()},XGRJ:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return c.a})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return d.a}));var o=n("lJxs"),i=n("N1MX"),s=n("fXoL"),r=n("tk/3");let a=(()=>{class t{constructor(t,e){this.http=t,this.logger=e}post(t,e){const n=this.formatUrl(t,e);return this.http.get(n).pipe(Object(o.a)(t=>{this.logger.info("post comment json response",t);const e=new i.JsonObject(t),n=e.getString("status");let o;return o="ok"===e.getString("stat")?"pending"===n?3:0:"pending"===n?1:2,o}))}formatUrl(e,n){return e.replace(t.NAME_TOKEN,encodeURIComponent(n.name)).replace(t.MAIL_TOKEN,encodeURIComponent(n.email)).replace(t.COMMENT_TOKEN,encodeURIComponent(n.content))}}return t.NAME_TOKEN="[name]",t.MAIL_TOKEN="[email]",t.COMMENT_TOKEN="[content]",t.\u0275fac=function(e){return new(e||t)(s.Wb(r.b),s.Wb(i.Logger))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var c=n("0taS"),l=(n("aECq"),n("ofXK")),g=n("LRne"),m=n("HDdC");let h=(()=>{class t{constructor(t,e,n){this.doc=t,this.location=e,this.languagesManager=n}load(t){return this.shortName===t?Object(g.a)(void 0):new m.a(e=>{let n=Object(l.M)().createElement("script");n.id="disqus-sdk",n.async=!0,n.defer=!0,n.src=`//${t}.disqus.com/embed.js`;const o=Object(l.M)().onAndCancel(n,"load",()=>{this.shortName=t,e.next(void 0),e.complete()}),i=Object(l.M)().onAndCancel(n,"error",t=>e.error(t));return this.doc.body.appendChild(n),()=>{o(),i()}})}reset(t){this.load(t.shortName).subscribe(()=>{window.DISQUS.reset({reload:!0,config:this.getConfig(t)})})}getConfig(t){const e=this;return function(){this.page.title=t.pageTitle,this.page.url=t.pageUrl||e.location.path(),this.page.identifier=t.pageIndentifier||this.page.url,this.page.category_id=t.pageCategoryId,this.language=e.languagesManager.currentLanguage}}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(l.e),s.Wb(l.n),s.Wb(i.LanguagesManager))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=n("HIV/")},aECq:function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var o=n("mrSG"),i=n("fXoL"),s=n("3Pt+"),r=n("IzEk"),a=n("N1MX"),c=n("33+q"),l=n("0taS"),g=n("jhN1"),m=n("r+G/"),h=n("ofXK"),d=n("kmnG"),u=n("qFsG"),b=n("wWjk"),p=n("etuB"),C=n("Pitf");function f(t,e){if(1&t&&(i.Sb(0,"div",7),i.Sb(1,"mat-form-field",8),i.Nb(2,"input",9),i.Rb(),i.Sb(3,"mat-form-field",8),i.Nb(4,"input",10),i.Rb(),i.Rb()),2&t){const t=i.dc();i.Ab(2),i.kc("placeholder",t.usernamePlaceholder)("gbFontStyle",t.textFont),i.Ab(2),i.kc("placeholder",t.usermailPlaceholder)("gbFontStyle",t.textFont)}}function M(t,e){if(1&t&&(i.Sb(0,"div",11),i.Nb(1,"gb-author-avatar",12),i.Sb(2,"span",13),i.Jc(3),i.Rb(),i.Rb()),2&t){const t=i.dc();i.Ec("border-bottom-color",t.separatorColor)("border-bottom-style",t.separatorType),i.Ab(1),i.kc("avatarUrl",t.user.urlPhoto)("name",t.user.displayName),i.Ab(1),i.kc("gbFontStyle",t.authorFont),i.Ab(1),i.Kc(t.user.name)}}let S=(()=>{class t{constructor(t,e,n,o,r,c){this.authService=t,this.settingsManager=e,this.languageManager=n,this.formBuilder=o,this.sharedStylesHost=r,this.platform=c,this.postComment=new i.n,this.postButtonLevel=1,this.form=this.formBuilder.group({pseudo:["",s.H.required],mail:["",a.FieldsValidators.mail(!0)],comment:["",s.H.required]})}ngOnInit(){this.postBarText=this.languageManager.getSend(),this.usernamePlaceholder=this.languageManager.getCommentUsernamePlaceholder(),this.usermailPlaceholder=this.languageManager.getCommentMailPlaceholder(),this.contentPlaceholder=this.languageManager.getFieldEnterText(),this.authService.loggedIn.pipe(Object(r.a)(1)).subscribe(t=>{const e=this.authService.authenticatedUser;t&&e.email&&(this.user=e,this.form=this.formBuilder.group({comment:["",s.H.required]}))}),this.separatorColor=this.settingsManager.getGeneralSeparatorColor();let t=this.settingsManager.getGeneralSeparatorType();this.separatorType=Object(a.borderStyleBySeparatorType)(t),this.authorFont=this.settingsManager.getSectionsCommentsAuthorFont(this.sectionId),this.textFont=this.settingsManager.getSectionsCommentsTextFont(this.sectionId),this.postButtonSettings=this.settingsManager.getSectionsCommentsPostButton(this.sectionId,this.postButtonLevel)}ngAfterViewInit(){const t=Object(a.hexToRgba)(this.textFont.color,.3),e=Object(a.hexToRgba)(this.textFont.color,.6),n=`\n            #comment-form .mat-form-field-underline { border-color: ${t}; background-color: ${t}; }\n            #comment-form .mat-form-field-underline .mat-form-field-ripple { background-color: ${t}}\n            #comment-form .mat-form-field-underline .mat-form-field-ripple.mat-focused { background-color: ${e}}\n            #comment-form .mat-form-field-label { color: ${t}}\n            #comment-form .mat-form-field-label.mat-focused { color: ${e}}\n        `;this.sharedStylesHost instanceof c.PreviewSharedStylesHost?this.sharedStylesHost.addOrReplaceStyles([n],"comment-form-fields"):this.sharedStylesHost.addStyles([n])}onCommentAreaClick(t){t.currentTarget.focus()}onSubmit(){if(this.form.valid)if(this.platform.isPreviewApp)this.platform.previewService.notAllowedInPreview();else{let t={};this.user?(t.name=this.user.name,t.email=this.user.email):(t.name=this.form.controls.pseudo.value,t.email=this.form.controls.mail.value),t.content=this.form.controls.comment.value,this.postComment.emit(t)}}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(a.AuthService),i.Mb(l.a),i.Mb(a.LanguagesManager),i.Mb(s.g),i.Mb(g.l),i.Mb(a.PlatformService))},t.\u0275cmp=i.Gb({type:t,selectors:[["gb-comment-form"]],inputs:{sectionId:"sectionId"},outputs:{postComment:"postComment"},decls:8,vars:12,consts:[["id","comment-form",3,"formGroup","ngSubmit"],["commentForm","ngForm"],["class","user-infos",4,"ngIf"],["class","user-avatar",3,"border-bottom-color","border-bottom-style",4,"ngIf"],[1,"comment-content"],["required","","formControlName","comment","matInput","","matTextareaAutosize","",3,"placeholder","matAutosizeMinRows","gbFontStyle","click"],["type","submit","gbButtonV2","",1,"button-inline",3,"disabled","buttonLevel","buttonSettings","buttonTitle"],[1,"user-infos"],[1,"input-container"],["matInput","","formControlName","pseudo",3,"placeholder","gbFontStyle"],["matInput","","formControlName","mail",3,"placeholder","gbFontStyle"],[1,"user-avatar"],[3,"avatarUrl","name"],[1,"author",3,"gbFontStyle"]],template:function(t,e){if(1&t&&(i.Sb(0,"form",0,1),i.Zb("ngSubmit",(function(){return e.onSubmit()})),i.Sb(2,"gb-scrollable-content"),i.Hc(3,f,5,4,"div",2),i.Hc(4,M,4,8,"div",3),i.Sb(5,"mat-form-field",4),i.Sb(6,"textarea",5),i.Zb("click",(function(t){return e.onCommentAreaClick(t)})),i.Rb(),i.Rb(),i.Nb(7,"button",6),i.Rb(),i.Rb()),2&t){const t=i.rc(1);i.kc("formGroup",e.form),i.Ab(3),i.kc("ngIf",!e.user),i.Ab(1),i.kc("ngIf",e.user),i.Ab(2),i.kc("placeholder",e.contentPlaceholder)("matAutosizeMinRows",10)("gbFontStyle",e.textFont),i.Ab(1),i.Eb("disabled",!t.form.valid),i.kc("disabled",!t.form.valid)("buttonLevel",e.postButtonLevel)("buttonSettings",e.postButtonSettings)("buttonTitle",e.postBarText)}},directives:[s.J,s.u,s.l,m.a,h.t,d.c,s.d,u.b,u.d,s.E,s.t,s.j,b.a,p.a,C.a],styles:["[_nghost-%COMP%]{display:block;height:100%}[_nghost-%COMP%]     .mat-form-field-wrapper{position:relative}form[_ngcontent-%COMP%]{display:block;height:100%;text-align:left}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 16px 16px}form[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{opacity:.5}gb-scrollable-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.user-infos[_ngcontent-%COMP%]{margin-top:20px}.user-avatar[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-shrink:0;align-items:center;border-bottom-width:1px;padding:18px}.user-avatar[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{margin-left:18px}.comment-content[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]{width:100%;padding:14px;box-sizing:border-box}.comment-content[_ngcontent-%COMP%]{flex-shrink:0;margin-bottom:auto}"]}),Object(o.b)([Object(c.PreviewListener)("sections")],t.prototype,"ngAfterViewInit",null),t})()},eMpa:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));var o=n("mrSG"),i=n("fXoL"),s=n("N1MX"),r=n("33+q"),a=n("XGRJ"),c=n("ofXK"),l=n("dNgK"),g=n("1G5W"),m=n("JX91"),h=n("pLZG"),d=n("eIep"),u=n("o3HB"),b=n("DyP3"),p=n("OPlM"),C=n("/+rk"),f=n("wWjk"),M=n("9U6E");function S(t,e){if(1&t&&i.Nb(0,"gb-item-author",6),2&t){const t=i.dc();i.kc("sectionId",t.sectionId)("item",t.comment)}}let x=(()=>{class t{constructor(t){this.settingsManager=t}ngOnChanges(t){this.authorFont=this.settingsManager.getSectionsCommentsAuthorFont(this.sectionId),this.textFont=this.settingsManager.getSectionsCommentsTextFont(this.sectionId),this.dateFont=this.settingsManager.getSectionsCommentsDateFont(this.sectionId),this.showThumb=this.settingsManager.getSectionsCommentsShowThumb(this.sectionId);const e=this.settingsManager.getSectionsCommentsDateToken(this.sectionId);this.dateString=this.comment.replaceTagsInString(e);const n=this.settingsManager.getGeneralSeparatorType();this.borderTypeString=Object(s.borderStyleBySeparatorType)(n),this.borderColor=this.settingsManager.getGeneralSeparatorColor()}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(a.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["gb-comment-list-classic-cell"]],hostVars:4,hostBindings:function(t,e){2&t&&i.Ec("border-style",e.borderTypeString)("border-color",e.borderColor)},inputs:{sectionId:"sectionId",comment:"comment"},features:[i.yb],decls:9,vars:7,consts:[[1,"comment-header"],["class","author",3,"sectionId","item",4,"ngIf"],[1,"infos"],[1,"author",3,"gbFontStyle"],[1,"date",3,"gbFontStyle"],[1,"content",3,"gbFontStyle"],[1,"author",3,"sectionId","item"]],template:function(t,e){1&t&&(i.Sb(0,"div",0),i.Hc(1,S,1,2,"gb-item-author",1),i.Sb(2,"div",2),i.Sb(3,"div",3),i.Jc(4),i.Rb(),i.Sb(5,"div",4),i.Jc(6),i.Rb(),i.Rb(),i.Rb(),i.Sb(7,"div",5),i.Jc(8),i.Rb()),2&t&&(i.Ab(1),i.kc("ngIf",e.showThumb),i.Ab(2),i.kc("gbFontStyle",e.authorFont),i.Ab(1),i.Kc(e.comment.author),i.Ab(1),i.kc("gbFontStyle",e.dateFont),i.Ab(1),i.Kc(e.dateString),i.Ab(1),i.kc("gbFontStyle",e.textFont),i.Ab(1),i.Lc(" ",e.comment.content,"\n"))},directives:[c.t,f.a,M.a],styles:["[_nghost-%COMP%]{display:block;text-align:left;border:0;border-bottom:1px solid transparent}[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{padding:18px}[_nghost-%COMP%]   .comment-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;padding:18px 18px 9px}[_nghost-%COMP%]   gb-item-author[_ngcontent-%COMP%]{margin-right:18px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{word-wrap:break-word;padding:9px 18px 18px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]   .title[_ngcontent-%COMP%]{padding:9px}[_nghost-%COMP%]   .comment-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;padding:9px 9px 4.5px}[_nghost-%COMP%]   gb-item-author[_ngcontent-%COMP%]{margin-right:9px}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{word-wrap:break-word;padding:4.5px 9px 9px}}"]}),Object(o.b)([Object(r.PreviewListener)("sections")],t.prototype,"ngOnChanges",null),t})();var y=n("bTqV"),k=n("ZCIf"),O=n("aECq");function P(t,e){1&t&&i.Nb(0,"gb-loading-spinner")}function I(t,e){if(1&t&&i.Nb(0,"gb-comment-list-classic-cell",10),2&t){const t=e.$implicit,n=i.dc(4);i.kc("sectionId",n.sectionId)("comment",t)}}function v(t,e){if(1&t&&(i.Sb(0,"div",8),i.Hc(1,I,1,2,"gb-comment-list-classic-cell",9),i.Rb()),2&t){const t=i.dc(3);i.Ab(1),i.kc("ngForOf",t.comments)}}function w(t,e){if(1&t){const t=i.Tb();i.Sb(0,"button",11),i.Zb("click",(function(e){return i.vc(t),i.dc(3).onPostButtonClick(e)})),i.Nb(1,"span",12),i.Rb()}if(2&t){const t=i.dc(3);i.Ec("background-color",t.postBackgroundColor),i.Ab(1),i.kc("color",t.postIconColor)}}function _(t,e){if(1&t&&(i.Qb(0),i.Hc(1,v,2,1,"div",6),i.Hc(2,w,2,3,"button",7),i.Pb()),2&t){const t=i.dc(2),e=i.rc(6);i.Ab(1),i.kc("ngIf",t.hasComments)("ngIfElse",e),i.Ab(1),i.kc("ngIf",t.postCommentEnabled)}}function T(t,e){if(1&t&&i.Hc(0,_,3,3,"ng-container",2),2&t){const t=i.dc(),e=i.rc(8);i.kc("ngIf",t.isListView)("ngIfElse",e)}}function B(t,e){if(1&t&&(i.Sb(0,"div",13),i.Nb(1,"span",14),i.Sb(2,"div",15),i.Jc(3),i.Rb(),i.Sb(4,"div",15),i.Jc(5),i.Rb(),i.Rb()),2&t){const t=i.dc();i.Ab(1),i.kc("iconUrl","no-comments")("color",t.dateFont.color)("size",7*t.dateFont.size),i.Ab(1),i.kc("gbFontStyle",t.authorFont),i.Ab(1),i.Kc(t.noContentTitle),i.Ab(1),i.kc("gbFontStyle",t.textFont),i.Ab(1),i.Kc(t.noContentBaseline)}}function F(t,e){if(1&t){const t=i.Tb();i.Sb(0,"gb-comment-form",16),i.Zb("postComment",(function(e){return i.vc(t),i.dc().onPostComment(e)})),i.Rb()}if(2&t){const t=i.dc();i.kc("sectionId",t.sectionId)}}let A=(()=>{class t{constructor(t,e,n,o,s,r,a){this.settingsManager=t,this.languageManager=e,this.dataManager=n,this.dataLoader=o,this.postCommentService=s,this.snackBar=r,this.cdr=a,this.closeClick=new i.n,this.comments=[],this.destroyed$=new i.n,this.snackbarConfig=new l.b,this.snackbarConfig.duration=3e3}get hasComments(){return this.comments.length>0}set listView(t){this.isListView=t,this.commentTitle=t?this.title:this.postTitle}set loading(t){this.isLoading=t,this.cdr.markForCheck()}ngOnInit(){this.title=this.languageManager.getCommentTitle(),this.postTitle=this.languageManager.getCommentPostTitle(),this.noContentTitle=this.languageManager.getCommentNoContent(),this.noContentBaseline=this.languageManager.getCommentNoContentBaseline(),this.listView=!0}ngOnChanges(t){t.sectionId&&t.sectionId.currentValue&&this.setCommentsStyles(),t.item&&t.item.currentValue&&(t.item.previousValue&&t.item.currentValue.id===t.item.previousValue.id||(this.comments=[],this.commentsUrl=this.item.commentsUrl,this.commentsPostUrl=this.item.commentsPostUrl,this.postCommentEnabled=null!==this.commentsPostUrl&&""!==this.commentsPostUrl,this.nextPageUrl=null,this.reachEnd=!1,this.loadComments(),this.listView=!0))}ngOnDestroy(){this.destroyed$.emit(),this.destroyed$.complete()}onCloseClick(){this.isListView?this.closeClick.emit():this.listView=!0}onPostButtonClick(t){this.listView=!1}onPostComment(t){this.loading=!0,this.postCommentService.post(this.commentsPostUrl,t).subscribe(t=>{let e;switch(this.onCommentAdded(t),t){case 0:e=this.languageManager.getCommentPostSuccess();break;case 3:e=this.languageManager.getCommentPostSuccess()+" "+this.languageManager.getCommentPostSuccessWaiting();break;default:e=this.languageManager.getCommentPostError()}this.snackBar.open(e,null,this.snackbarConfig)},()=>{this.loading=!1,this.snackBar.open(this.languageManager.getCommentPostError(),null,this.snackbarConfig)})}onCommentAdded(t){this.loading=!1,0!==t&&3!==t||(this.reachEnd=!1,this.nextPageUrl=null,this.comments=new Array,this.dataLoader.notify(),this.listView=!0)}setCommentsStyles(){this.titleFont=this.settingsManager.getSectionsTitleFont(this.sectionId),this.dateFont=this.settingsManager.getSectionsCommentsDateFont(this.sectionId),this.textFont=this.settingsManager.getSectionsCommentsTextFont(this.sectionId),this.authorFont=this.settingsManager.getSectionsCommentsAuthorFont(this.sectionId),this.postIconColor=this.settingsManager.getSectionsCommentsPostBarIconColor(this.sectionId),this.listBackgroundOpacity=this.settingsManager.getSectionsCommentsListBackgroundOpacity(this.sectionId);const t=Object(s.visibleColorFinder)(this.settingsManager.getSectionsCommentsListBackgroundColor(this.sectionId),this.settingsManager.getGeneralBackgroundColor(),"#ffffff");this.listBackgroundColor=Object(s.hexToRgba)(t,this.listBackgroundOpacity),this.postBackgroundColor=this.settingsManager.getSectionsCommentsPostBarBackgroundColor(this.sectionId)}loadComments(){this.dataLoader.notified.pipe(Object(g.a)(this.destroyed$),Object(m.a)(0),Object(h.a)(()=>!this.isLoading&&!this.reachEnd),Object(d.a)(()=>(this.loading=!0,this.dataManager.getComments(this.sectionId,this.nextPageUrl?this.nextPageUrl:this.commentsUrl)))).subscribe(t=>{if(this.comments=this.comments.concat(...t.items),this.nextPageUrl=t.nextPage,this.reachEnd=!this.nextPageUrl||t.items.length<1,this.loading=!1,this.item.nbComments!==this.comments.length&&(this.comments.length>this.item.nbComments||this.reachEnd)){const t=this.item.cloneRawInstance();t.updateNbComments(this.comments.length),this.dataManager.itemUpdated$.next(t)}},()=>this.loading=!1,()=>this.loading=!1)}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(a.a),i.Mb(s.LanguagesManager),i.Mb(s.DataManager),i.Mb(s.LoadMoreManager),i.Mb(a.d),i.Mb(l.a),i.Mb(i.h))},t.\u0275cmp=i.Gb({type:t,selectors:[["gb-comment-list-classic"]],hostVars:2,hostBindings:function(t,e){2&t&&i.Ec("background-color",e.listBackgroundColor)},inputs:{sectionId:"sectionId",item:"item"},outputs:{closeClick:"closeClick"},features:[i.yb],decls:9,vars:4,consts:[["leftIconUrl","close",3,"sectionId","title","clickLeft"],[1,"comments-container"],[4,"ngIf","ngIfElse"],["commentsListView",""],["commentsPlaceholder",""],["commentsForm",""],["class","comments-list","gbScrollable","","gbInfiniteScrollContentLoader","",4,"ngIf","ngIfElse"],["mat-icon-button","",3,"background-color","click",4,"ngIf"],["gbScrollable","","gbInfiniteScrollContentLoader","",1,"comments-list"],[3,"sectionId","comment",4,"ngFor","ngForOf"],[3,"sectionId","comment"],["mat-icon-button","",3,"click"],["gbIcon","","iconUrl","chat-newmessage",3,"color"],[1,"nocomment"],["gbIcon","",3,"iconUrl","color","size"],[3,"gbFontStyle"],[3,"sectionId","postComment"]],template:function(t,e){if(1&t&&(i.Sb(0,"gb-sidenav-header",0),i.Zb("clickLeft",(function(){return e.onCloseClick()})),i.Rb(),i.Sb(1,"div",1),i.Hc(2,P,1,0,"gb-loading-spinner",2),i.Rb(),i.Hc(3,T,1,2,"ng-template",null,3,i.Ic),i.Hc(5,B,6,7,"ng-template",null,4,i.Ic),i.Hc(7,F,1,1,"ng-template",null,5,i.Ic)),2&t){const t=i.rc(4);i.kc("sectionId",e.sectionId)("title",e.commentTitle),i.Ab(2),i.kc("ngIf",e.isLoading)("ngIfElse",t)}},directives:[u.a,c.t,b.a,p.a,C.a,c.s,x,y.b,k.a,f.a,O.a],styles:["[_nghost-%COMP%]{flex-direction:column;flex:1;height:100%}.title[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;position:relative}.title[_ngcontent-%COMP%]{height:64px;padding:20px;text-align:center;flex-direction:row;justify-content:center;align-items:center;cursor:pointer}.title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;flex:1;flex-shrink:0;font-size:24px!important}.comments-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 0;height:100%;justify-content:center}.comments-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.nocomment[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;flex:1;text-align:center}.nocomment[_ngcontent-%COMP%]   [gbIcon][_ngcontent-%COMP%]{margin-bottom:20px}[mat-icon-button][_ngcontent-%COMP%]{position:absolute;height:56px;width:56px;bottom:24px;right:24px}[mat-icon-button][_ngcontent-%COMP%]   [gbIcon][_ngcontent-%COMP%]{line-height:56px;text-align:center}@media only screen and (orientation:landscape) and (min-width:960px) and (max-width:1279px),only screen and (orientation:portrait) and (min-width:600px) and (max-width:1024px){.title[_ngcontent-%COMP%]{height:44px;padding:10px}.title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px!important}}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.title[_ngcontent-%COMP%]{height:44px;padding:10px}.title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px!important}.comments-list[_ngcontent-%COMP%]{padding-bottom:env(safe-area-inset-bottom)}}"]}),Object(o.b)([Object(r.PreviewListener)("sections")],t.prototype,"setCommentsStyles",null),t})(),G=(()=>{class t{constructor(t,e,n){this.disqusService=t,this.languageManager=e,this.settingsManager=n,this.closeClick=new i.n}ngOnChanges(t){if(t.sectionId&&t.sectionId.currentValue){this.title=this.languageManager.getCommentTitle(),this.disqusShortName=this.settingsManager.getSectionsDisqusShortName(this.sectionId),this.headerTitleFont=this.settingsManager.getSectionsNavBarTitleFont(this.sectionId),this.headerBackgroundColor=this.settingsManager.getSectionsNavBarBackgroundColor(this.sectionId);const t=Object(s.visibleColorFinder)(this.settingsManager.getSectionsCommentsListBackgroundColor(this.sectionId),this.settingsManager.getGeneralBackgroundColor(),"#ffffff"),e=this.settingsManager.getSectionsCommentsListBackgroundOpacity(this.sectionId);this.listBackgroundColor=Object(s.hexToRgba)(t,e);const n=this.settingsManager.getSectionsNavBarBorderColor(this.sectionId);this.borderStyle=n&&"transparent"!==n?"1px solid "+n:""}this.disqusService.reset({shortName:this.disqusShortName,pageTitle:this.item.title,pageIndentifier:this.item.id,pageUrl:this.item.disqusPageUrl})}onCloseClick(){this.closeClick.emit(void 0)}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(a.c),i.Mb(s.LanguagesManager),i.Mb(a.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["gb-comment-list-disqus"]],hostVars:2,hostBindings:function(t,e){2&t&&i.Ec("background-color",e.listBackgroundColor)},inputs:{sectionId:"sectionId",item:"item"},outputs:{closeClick:"closeClick"},features:[i.yb],decls:7,vars:8,consts:[[1,"title",3,"click"],["gbIcon","","iconUrl","close",3,"size","color"],[3,"gbFontStyle"],[1,"comments-container"],[1,"comments-list"],["id","disqus_thread"]],template:function(t,e){1&t&&(i.Sb(0,"div",0),i.Zb("click",(function(){return e.onCloseClick()})),i.Nb(1,"span",1),i.Sb(2,"h1",2),i.Jc(3),i.Rb(),i.Rb(),i.Sb(4,"div",3),i.Sb(5,"div",4),i.Nb(6,"div",5),i.Rb(),i.Rb()),2&t&&(i.Ec("border-bottom",e.borderStyle)("background-color",e.headerBackgroundColor),i.Ab(1),i.kc("size",24)("color",e.headerTitleFont.color),i.Ab(1),i.kc("gbFontStyle",e.headerTitleFont),i.Ab(1),i.Lc(" ",e.title," "))},directives:[k.a,f.a],styles:["[_nghost-%COMP%]{flex-direction:column;flex:1;height:100%}.title[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;position:relative}.title[_ngcontent-%COMP%]{height:64px;padding:20px;text-align:center;flex-direction:row;justify-content:center;align-items:center;cursor:pointer}.title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;flex:1;flex-shrink:0;font-size:24px!important}.comments-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 0;height:100%;justify-content:center}.comments-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.nocomment[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;flex:1;text-align:center}.nocomment[_ngcontent-%COMP%]   [gbIcon][_ngcontent-%COMP%]{margin-bottom:20px}[mat-icon-button][_ngcontent-%COMP%]{position:absolute;height:56px;width:56px;bottom:24px;right:24px}[mat-icon-button][_ngcontent-%COMP%]   [gbIcon][_ngcontent-%COMP%]{line-height:56px;text-align:center}@media only screen and (orientation:landscape) and (min-width:960px) and (max-width:1279px),only screen and (orientation:portrait) and (min-width:600px) and (max-width:1024px){.title[_ngcontent-%COMP%]{height:44px;padding:10px}.title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px!important}}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.title[_ngcontent-%COMP%]{height:44px;padding:10px}.title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px!important}.comments-list[_ngcontent-%COMP%]{padding-bottom:env(safe-area-inset-bottom)}}",".comments-list[_ngcontent-%COMP%]{padding:9px 18px;text-align:initial}.title[_ngcontent-%COMP%]{height:44px;height:calc(env(safe-area-inset-top) + 44px);padding-top:calc(env(safe-area-inset-top) + 10px)}"]}),Object(o.b)([Object(r.PreviewListener)("sections")],t.prototype,"ngOnChanges",null),t})();function L(t,e){if(1&t){const t=i.Tb();i.Sb(0,"gb-comment-list-classic",3),i.Zb("closeClick",(function(){return i.vc(t),i.dc(2).onCloseClick()})),i.Rb()}if(2&t){const t=i.dc(2);i.kc("sectionId",t.sectionId)("item",t.item)}}function N(t,e){if(1&t&&i.Hc(0,L,1,2,"ng-template",2),2&t){const t=i.dc();i.kc("ngSwitchCase",t.types.Classic)}}function j(t,e){if(1&t){const t=i.Tb();i.Sb(0,"gb-comment-list-disqus",3),i.Zb("closeClick",(function(){return i.vc(t),i.dc().onCloseClick()})),i.Rb()}if(2&t){const t=i.dc();i.kc("sectionId",t.sectionId)("item",t.item)}}let R=(()=>{class t{constructor(t,e){this.settingsManager=t,this.scroll=e,this.closeComments=new i.n,this.types=s.CommentTemplateType}ngOnChanges(t){this.type=this.settingsManager.getSectionsCommentTemplateType(this.sectionId),this.settingsManager.getSectionsDisqusEnabled(this.sectionId)?this.type=s.CommentTemplateType.Disqus:(this.classicAvailable=this.item.commentsAvailable(),this.classicAvailable||this.onCloseClick())}onCloseClick(){this.closeComments.emit(null)}ngOnDestroy(){this.scroll.unblockScroll()}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(a.a),i.Mb(s.ScrollService))},t.\u0275cmp=i.Gb({type:t,selectors:[["gb-comment-list"]],inputs:{sectionId:"sectionId",item:"item"},outputs:{closeComments:"closeComments"},features:[i.zb([s.LoadMoreManager]),i.yb],decls:3,vars:3,consts:[[3,"ngSwitch"],[4,"ngIf"],[3,"ngSwitchCase"],[3,"sectionId","item","closeClick"]],template:function(t,e){1&t&&(i.Qb(0,0),i.Hc(1,N,1,1,void 0,1),i.Hc(2,j,1,2,"ng-template",2),i.Pb()),2&t&&(i.kc("ngSwitch",e.type),i.Ab(1),i.kc("ngIf",e.classicAvailable),i.Ab(1),i.kc("ngSwitchCase",e.types.Disqus))},directives:[c.x,c.t,c.y,A,G],styles:["@media only screen and (orientation:landscape) and (max-width:1279px),only screen and (orientation:portrait) and (max-width:1024px){[_nghost-%COMP%]     .avatar{width:48px;height:48px;line-height:48px}[_nghost-%COMP%]     .avatar.avatar-color{font-size:30px}}"]}),Object(o.b)([Object(r.PreviewListener)("sections")],t.prototype,"ngOnChanges",null),t})()}}]);
//# sourceMappingURL=2-es2015.35a5721b8b55b18d8b8c.js.map